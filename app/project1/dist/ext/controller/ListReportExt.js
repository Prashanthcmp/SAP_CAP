sap.ui.define(["sap/m/MessageBox","sap/m/MessageToast","sap/ui/core/UIComponent","sap/ui/export/library","sap/ui/export/Spreadsheet"],function(e,r,t,o,n){"use strict";var a=o.EdmType;function p(){var e=[];e.push({type:a.Number,property:"PurchaseCategory",scale:0});e.push({property:"ProductCategory",type:a.String});e.push({property:"ModelNumber",type:a.String});e.push({property:"ProductId",type:a.String});e.push({property:"ProductName",type:a.String});e.push({property:"Mrp",type:a.Number});e.push({property:"StaffPrice",type:a.Number});e.push({property:"Color",type:a.String});e.push({property:"Avilability",type:a.String});e.push({property:"DeliverHome",type:a.String});return e}function u(e){var r;function t(){r&&r.close()}return{onBeforeOpen:function(t){r=t.getSource();e.addDependent(r)},onAfterClose:function(t){e.removeDependent(r);r.destroy();r=undefined},onCancel:function(e){t()}}}function i(t,o){var n;function a(e){n&&n.getBeginButton().setEnabled(e)}function p(e){n.setBusy(e)}function u(){n&&n.close()}function i(r,t,o){e.error("Upload failed",{title:"Error"})}function l(e){return sap.ui.core.Fragment.byId("excelUploadDialog",e)}return{onBeforeOpen:function(e){n=e.getSource();t.addDependent(n)},onAfterClose:function(e){t.removeDependent(n);n.destroy();n=undefined},onOk:function(e){p(true);debugger;var r=l("uploader");var n=new sap.ui.unified.FileUploaderParameter;n.setName("slug");n.setValue(o);r.removeHeaderParameter("slug");r.addHeaderParameter(n);n.setName("x-csrf-token");n.setValue(t._view.getModel().mHeaders["X-CSRF-Token"]);r.addHeaderParameter(n);var a=t._controller.extensionAPI._controller._oAppComponent.getManifestObject().resolveUri("./odata/v4/catalog/ExcelUpload/excel");r.setUploadUrl(a);r.checkFileReadable().then(function(){r.upload()}).catch(function(e){i("The file cannot be read.");p(false)})},onCancel:function(e){u()},onTypeMismatch:function(e){var r=e.getSource().getFileType().map(function(e){return"*."+e}).join(", ");i("The file type *."+e.getParameter("fileType")+" is not supported. Choose one of the following types: "+r)},onFileAllowed:function(e){a(true)},onFileEmpty:function(e){a(false)},onUploadComplete:function(e){var o=e.getParameter("status");var n=e.getSource();n.clear();a(false);p(false);if(o>=400){var l;try{l=JSON.parse(e.getParameter("responseRaw"))}catch(r){l=e.getParameter("responseRaw")}if(l&&l.error&&l.error.message){i(l.error.code,l.error.target,l&&l.error&&l.error.message)}}else{r.show("File uploaded successfully");t.refresh();u()}}}}return{onUploadExcel:function(e){r.show("Custom handler invoked.");this.loadFragment({id:"excelUploadDialog",name:"project1.ext.fragment.ExcelUploadDialog",controller:i(this,"Products")}).then(function(e){e.open()})},onDownloadTemplate:function(){var e,r,t,o,a;e=p();e.push(["Project","Project1"]);t={workbook:{columns:e,hierarchyLevel:"Level"},dataSource:[],fileName:"Table export sample.xlsx",worker:false};o=new n(t);o.build().finally(function(){o.destroy()})},onProductCategory:function(){this.loadFragment({id:"idProductCategory",name:"project1.ext.fragment.ProductCategory",controller:u(this)}).then(function(e){e.open()})}}});
//# sourceMappingURL=ListReportExt.js.map