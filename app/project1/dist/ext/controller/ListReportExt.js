sap.ui.define(["sap/m/MessageBox","sap/m/MessageToast","sap/ui/core/UIComponent","sap/ui/export/library","sap/ui/export/Spreadsheet"],function(e,r,t,o,a){"use strict";var n=o.EdmType;function p(){var e=[];e.push({type:n.Number,property:"PurchaseCategory",scale:0});e.push({property:"ProductCategory",type:n.String});e.push({property:"ModelNumber",type:n.String});e.push({property:"ProductId",type:n.String});e.push({property:"ProductName",type:n.String});e.push({property:"Mrp",type:n.Number});e.push({property:"StaffPrice",type:n.Number});e.push({property:"Color",type:n.String});e.push({property:"Avilability",type:n.String});e.push({property:"DeliverHome",type:n.String});return e}function l(t,o){var a;function n(e){a&&a.getBeginButton().setEnabled(e)}function p(e){a.setBusy(e)}function l(){a&&a.close()}function s(r,t,o){e.error("Upload failed",{title:"Error"})}function i(e){return sap.ui.core.Fragment.byId("excelUploadDialog",e)}return{onBeforeOpen:function(e){a=e.getSource();t.addDependent(a)},onAfterClose:function(e){t.removeDependent(a);a.destroy();a=undefined},onOk:function(e){p(true);debugger;var r=i("uploader");var a=new sap.ui.unified.FileUploaderParameter;a.setName("slug");a.setValue(o);r.removeHeaderParameter("slug");r.addHeaderParameter(a);a.setName("x-csrf-token");a.setValue(t._view.getModel().mHeaders["X-CSRF-Token"]);r.addHeaderParameter(a);var n=t._controller.extensionAPI._controller._oAppComponent.getManifestObject().resolveUri("./odata/v4/catalog/ExcelUpload/excel");r.setUploadUrl(n);r.checkFileReadable().then(function(){r.upload()}).catch(function(e){s("The file cannot be read.");p(false)})},onCancel:function(e){l()},onTypeMismatch:function(e){var r=e.getSource().getFileType().map(function(e){return"*."+e}).join(", ");s("The file type *."+e.getParameter("fileType")+" is not supported. Choose one of the following types: "+r)},onFileAllowed:function(e){n(true)},onFileEmpty:function(e){n(false)},onUploadComplete:function(e){var o=e.getParameter("status");var a=e.getSource();a.clear();n(false);p(false);if(o>=400){var i;try{i=JSON.parse(e.getParameter("responseRaw"))}catch(r){i=e.getParameter("responseRaw")}if(i&&i.error&&i.error.message){s(i.error.code,i.error.target,i&&i.error&&i.error.message)}}else{r.show("File uploaded successfully");t.refresh();l()}}}}return{onUploadExcel:function(e){r.show("Custom handler invoked.");this.loadFragment({id:"excelUploadDialog",name:"project1.ext.fragment.ExcelUploadDialog",controller:l(this,"Products")}).then(function(e){e.open()})},onDownloadTemplate:function(){var e,r,t,o,n;e=p();e.push(["Project","Project1"]);t={workbook:{columns:e,hierarchyLevel:"Level"},dataSource:[],fileName:"Table export sample.xlsx",worker:false};o=new a(t);o.build().finally(function(){o.destroy()})}}});
//# sourceMappingURL=ListReportExt.js.map